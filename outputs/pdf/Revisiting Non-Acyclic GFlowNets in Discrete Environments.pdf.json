{
  "code_links": [
    "https://github.com/GreatDrake/non-acyclic-gfn"
  ],
  "tasks": [
    "Generative Flow Networks (GFlowNets)"
  ],
  "datasets": [
    "Hypergrids",
    "Permutations"
  ],
  "methods": [
    "Non-acyclic GFlowNets",
    "Loss Stability",
    "State Flow Regularization"
  ],
  "results": [
    "Improved Sampling Quality",
    "Stable Losses",
    "Low Expected Trajectory Length"
  ],
  "title": "Revisiting Non-Acyclic GFlowNets in Discrete Environments.pdf",
  "abstract": "Generative Flow Networks (GFlowNets) are a family of generative models that learn to sample objects from a given probability distribution, po- tentially known up to a normalizing constant. In- stead of working in the object space, GFlowNets proceed by sampling trajectories in an appro- priately constructed directed acyclic graph en- vironment, greatly relying on the acyclicity of the graph. In our paper, we revisit the theory that relaxes the acyclicity assumption and present a simpler theoretical framework for non-acyclic GFlowNets in discrete environments. Moreover, we provide various novel theoretical insights re- lated to training with fixed backward policies, the nature of flow functions, and connections be- tween entropy-regularized RL and non-acyclic GFlowNets, which naturally generalize the re- spective concepts and theoretical results from the acyclic setting. In addition, we experimentally re-examine the concept of loss stability in non- acyclic GFlowNet training, as well as validate our own theoretical findings. 1. Introduction Generative Flow Networks (GFlowNets, Bengio et al., 2021) are models that aim to sample discrete objects from distri- butions known up to proportionality constant. They operate by constructing an object through a sequence of stochastic transitions defined by a forward policy. GFlowNets have been successfully applied in various areas, starting from molecule generation (Bengio et al., 2021) and biological se- quence design (Jain et al., 2022) to combinatorial optimiza- tion (Zhang et al., 2023) and fine-tuning of diffusion models (Uehara et al., 2024). The detailed theoretical foundations of GFlowNets in discrete environments were developed in *Equal contribution 1HSE University, Moscow, Russia 2CMAP \u2013 CNRS \u2013 \u00b4Ecole polytechnique \u2013 Institut Polytechnique de Paris, 91128, Palaiseau, France 3Universit\u00b4e Paris-Saclay, CNRS, LMO, 91405, Orsay, France. Correspondence to: Nikita Morozov <nvmorozov@hse.ru>. Preprint. Copyright 2025 by the author(s). (Bengio et al., 2023). While the majority of GFlowNet lit- erature consider the discrete setting, it is possible to apply the methodology of continuous GFlowNets (Lahlou et al., 2023) to sampling problems on more general spaces. The main idea behind the generation process in GFlowNets lies in sampling trajectories in the appropriately constructed directed acyclic graph environment instead of working di- rectly in the object space. A standard intuition behind this process is a sequence of actions applied in order to con- struct a composite object from \u201dblocks\u201d. One of the limita- tions of this setting is that it requires acyclicity. While this limitation can be naturally interpreted in, e.g., molecular generation setting, it can potentially restrict the applicabil- ity of GFlowNets in other scenarios, e.g. in standard RL environments or for sampling objects with intrinsic symme- tries which are better modeled in a non-acyclic environment, like a Cayley graph of Rubick\u2019s cube. To the best of our knowledge, methodological aspects of working with non- acyclic graphs in GFlowNets were previously considered only in the recent work (Brunswic et al., 2024). The latter paper, similarly to (Lahlou et al., 2023), uses the machinery of measurable spaces and measure theory, which is harder to build new extensions and methodology upon. We be- lieve that simplicity is a key merit of the theory behind discrete GFlowNets (Bengio et al., 2023) when compared to their general state counterparts. Thus, the main aim of our paper is to revisit the theory of non-acyclic GFlowNets with a discrete state space, simplifying the constructions of (Brunswic et al., 2024) and providing additional theoreti- cal and methodological insights into training GFlowNets in this setting. The main contributions of the paper can be summarized as follows: 1. We present a simple and intuitive way to build a theory of non-acyclic GFlowNets in discrete environments from scratch. In addition to simplicity, our construction in- troduces and clarifies a number of key points regarding similarities and dissimilarities between acyclic and non- acyclic discrete GFlowNets that were not explored in (Brunswic et al., 2024), in particular regarding the nature of flows and importance of backward policies. 2. We show that when the backward policy is fixed, the loss stability introduced by (Brunswic et al., 2024) does not impact the result of the optimization procedure. The latter becomes important only when the backward policy 1 arXiv:2502.07735v1 [cs.LG] 11 Feb 2025"
}