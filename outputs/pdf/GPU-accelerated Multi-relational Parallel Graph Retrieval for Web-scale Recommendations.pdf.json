{
  "code_links": [
    "None"
  ],
  "tasks": [
    "Web-scale Recommendations"
  ],
  "datasets": [
    "None"
  ],
  "methods": [
    "Multi-relational User-Item Relevance Metric Learning",
    "Hierarchically Parallel Approximate Nearest Neighbor Search",
    "GPU-accelerated"
  ],
  "results": [
    "GMP-GR achieves higher retrieval accuracy and efficiency compared to baseline methods",
    "Deployed across more than twenty applications at Baidu, serving hundreds of millions of users with a throughput exceeding one hundred million requests per second"
  ],
  "title": "GPU-accelerated Multi-relational Parallel Graph Retrieval for Web-scale Recommendations.pdf",
  "abstract": "Web recommendations provide personalized items from massive catalogs for users, which rely heavily on retrieval stages to trade off the effectiveness and efficiency of selecting a small relevant set from billion-scale candidates in online digital platforms. As one of the largest Chinese search engine and news feed providers, Baidu resorts to Deep Neural Network (DNN) and graph-based Approx- imate Nearest Neighbor Search (ANNS) algorithms for accurate relevance estimation and efficient search for relevant items. How- ever, current retrieval at Baidu fails in comprehensive user-item relational understanding due to dissected interaction modeling, and performs inefficiently in large-scale graph-based ANNS because of suboptimal traversal navigation and the GPU computational bottleneck under high concurrency. To this end, we propose a GPU- accelerated Multi-relational Parallel Graph Retrieval (GMP-GR) framework to achieve effective yet efficient retrieval in web-scale recommendations. First, we propose a multi-relational user-item rel- evance metric learning method that unifies diverse user behaviors through multi-objective optimization and employs a self-covariant loss to enhance pathfinding performance. Second, we develop a hierarchical parallel graph-based ANNS to boost graph retrieval throughput, which conducts breadth-depth-balanced searches on a large-scale item graph and cost-effectively handles irregular neural computation via adaptive aggregation on GPUs. In addition, we integrate system optimization strategies in the deployment of GMP- GR in Baidu. Extensive experiments demonstrate the superiority of GMP-GR in retrieval accuracy and efficiency. Deployed across more than twenty applications at Baidu, GMP-GR serves hundreds of millions of users with a throughput exceeding one hundred million requests per second. Keywords Recommender system, information retrieval, approximate nearest neighbor search, parallel computing 1 Introduction Recently, recommender systems have become essential tools for helping users navigate various options and discover relevant prod- ucts or content [30]. However, large-scale relevance evaluation based on user preference is computationally prohibitive in real- world recommendation applications [36]. For timely answering requirements, computing relevance values of billions of items is unacceptable [16]. To balance effectiveness and efficiency, retrieval- and-ranking recommendation frameworks [4, 19] have gained wide- spread adoption in modern industrial systems, such as YouTube [5], LinkedIn [2], and Pinterest [7]. The first stage (i.e., retrieval) fo- cuses on retrieving a thousand-scale relevant subset from the entire billion-scale item catalog, which then serves as the candidates for further ordering in the second stage (i.e., ranking). In particular, re- trieval plays an important role in real-time and satisfactory answers for large-scale queries. Effective retrieval can significantly simplify the search space for potential answers while maintaining person- alization and serendipity, thus reducing the ranking difficulty in producing reliable final recommendations. In this work, we focus on the retrieval stage in Baidu\u2019s web-scale recommendation scenarios, e.g., news feed, Tieba, and video clips. Recent works [3, 26] establish the retrieval framework in a training- and-search manner. Based on the complex relational dependencies modeling ability of Deep Neural Network (DNN) [34], they attempt to train a DNN-based metric for more accurate user-item relevance estimation compared with simple functions [6, 27]. Nevertheless, real-time retrieval is difficult due to complicated neural compu- tations on massive candidates. To solve the problem, researchers have been exploring the potential of Approximate Nearest Neigh- bor Search (ANNS) algorithms to mitigate extensive computations, which search for relatively relevant items for each query user by selectively visiting instead of the entire item base. Early works propose tree-based ANNS to organize data points in a tree-like structure by recursively splitting the dimensional space [10]. How- ever, they underperform in web-scale recommendations that aim to retrieve divergent and high-dimensional information. Because they are sensitive to complex feature space and item relationships [29]. To improve retrieval effectiveness, the latest frameworks leverage graph-based ANNS algorithms that build similarity-based candidate graphs to efficiently expand the candidate set via graph traversal. For example, HNSW [21] hierarchically establishes a multi-layer indexing graph, grounding coarse-to-fine navigation towards the most satisfactory candidates. However, we confront three challenges in developing an accurate and efficient retrieval framework for web-scale recommendations. (1) Unified modeling of multi-relational user-item relevance. Baidu recommendation applications consist of dozens of distinct and re- lated behaviors (e.g., click, browse) that are typically modeled by a tailored metric for estimating relevance between users and items. However, the independent modeling of these user-item interactions fails to capture the semantic relations of diverse user behaviors, which are mutually beneficial between them [26]. Besides, train- ing multiple behavior-specific metrics incurs exponential efforts in system updates. Thus, the first challenge lies in cost-effectively multi-relational metric joint training for more accurate relevance estimation. (2) Efficient search on large-scale graph item base. Baidu arXiv:2502.11490v1 [cs.LG] 17 Feb 2025"
}