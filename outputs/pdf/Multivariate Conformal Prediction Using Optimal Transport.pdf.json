{
  "code_links": "None",
  "tasks": [
    "Conformal Prediction"
  ],
  "datasets": [
    "None"
  ],
  "methods": [
    "Optimal Transport",
    "Entropic Map",
    "Brenier Map",
    "Sinkhorn Algorithm"
  ],
  "results": [
    "Improved Coverage Guarantees",
    "Better Performance in Multivariate Regression",
    "Computational Efficiency"
  ],
  "title": "Multivariate Conformal Prediction Using Optimal Transport.pdf",
  "abstract": "Conformal prediction (CP) quantifies the uncer- tainty of machine learning models by construct- ing sets of plausible outputs. These sets are constructed by leveraging a so-called conformity score, a quantity computed using the input point of interest, a prediction model, and past observa- tions. CP sets are then obtained by evaluating the conformity score of all possible outputs, and se- lecting them according to the rank of their scores. Due to this ranking step, most CP approaches rely on a score functions that are univariate. The chal- lenge in extending these scores to multivariate spaces lies in the fact that no canonical order for vectors exists. To address this, we leverage a nat- ural extension of multivariate score ranking based on optimal transport (OT). Our method, OT-CP, offers a principled framework for constructing conformal prediction sets in multidimensional set- tings, preserving distribution-free coverage guar- antees with finite data samples. We demonstrate tangible gains in a benchmark dataset of multi- variate regression problems and address compu- tational & statistical trade-offs that arise when estimating conformity scores through OT maps. 1. Introduction Conformal prediction (CP) (Gammerman et al., 1998; Vovk et al., 2005; Shafer & Vovk, 2008) has emerged as a simple framework to quantify the prediction uncertainty of ma- chine learning algorithms without relying on distributional assumptions on the data. For a sequence of observed data, and a new input point, Dn = {(x1, y1), ..., (xn, yn)} and xn+1, the objective is to construct a set that contains the unob- served response yn+1 with a specified confidence level 100(1 \u2212\u03b1)%. This involves evaluating scores S(x, y, \u02c6y) \u2208 *Equal contribution 1Apple. Correspondence to: Eugene Ndiaye <e ndiaye@apple.com>. R such as the prediction error of a model \u02c6y, for each obser- vation (x, y) in Dn and ranking these score values. The con- formal prediction set for the new input xn+1 is the collection of all possible responses y whose score S(xn+1, y, \u02c6y) ranks small enough to meet the prescribed confidence threshold, compared to the scores S(xi, yi, \u02c6y) in the observed data. CP has undergone tremendous developments in recent years (Barber et al., 2023; Park et al., 2024; Tibshirani et al., 2019; Guha et al., 2024) which mirror its increased applicability to challenging settings (Straitouri et al., 2023; Lu et al., 2022). To name a few, it has been applied for designing uncertainty sets in active learning (Ho & Wechsler, 2008), anomaly detection (Laxhammar & Falkman, 2015; Bates et al., 2021), few-shot learning (Fisch et al., 2021), time series (Chernozhukov et al., 2018; Xu & Xie, 2021; Chernozhukov et al., 2021; Lin et al., 2022; Zaffran et al., 2022), or to infer performance guarantees for statistical learning algorithms (Holland, 2020; Cella & Ryan, 2020); and recently to Large Language Models (Kumar et al., 2023; Quach et al., 2023). We refer to the extensive reviews in (Balasubramanian et al., 2014) for other applications in machine learning. By design, CP requires the notion of order, as the inclu- sion of a candidate response depends on its relative rank- ing to the scores observed previously. Hence, the classi- cal strategies developed so far largely target score func- tions with univariate outputs. This limits their applicability to multivariate responses, as ranking multivariate scores S(x, y, \u02c6y) \u2208Rd, d \u22652 is not as straightforward as ranking univariate scores in R. Ordering Vector Distributions using Optimal Transport. In parallel to these developments, and starting with the sem- inal reference of (Chernozhukov et al., 2017) and more generally the pioneering work of (Hallin et al., 2021; 2022; 2023), multiple references have explored the possibilities offered by the optimal transport theory to define a meaning- ful ranking or ordering in a multidimensional space. Simply put, the analog of a rank function computed on the data can be found in the optimal Brenier map that transports the data measure to a uniform, symmetric, centered measure of refer- ence in Rd. As a result, a simple notion of a univariate rank for a vector z \u2208Rd can be found by evaluating the distance of the image of z (according to that optimal map) to the ori- gin. This approach ensures that the ordering respects both 1 arXiv:2502.03609v1 [stat.ML] 5 Feb 2025"
}