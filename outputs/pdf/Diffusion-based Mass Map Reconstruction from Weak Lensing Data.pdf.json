{
  "code_links": [
    "None"
  ],
  "tasks": [
    "Mass map reconstruction from weak lensing data"
  ],
  "datasets": [
    "MassiveNuS simulations"
  ],
  "methods": [
    "Diffusion-based generative models",
    "Diffusion Posterior Sampling (DPS)"
  ],
  "results": [
    "Accurate high-resolution (sub-arcminute) mass maps",
    "Correct power spectrum and a range of non-Gaussian summary statistics"
  ],
  "title": "Diffusion-based Mass Map Reconstruction from Weak Lensing Data.pdf",
  "abstract": "Boruah,1, \u2217Michael Jacob,1, \u2020 and Bhuvnesh Jain1, \u2021 1Department of Physics and Astronomy, University of Pennsylvania, Philadelphia, PA 19104, USA (Dated: February 7, 2025) Diffusion models have been used in cosmological applications as a generative model for fast simulations and to reconstruct underlying cosmological fields or astrophysical images from noisy data. These two tasks are often treated as separate: diffusion models trained for one purpose do not generalize to perform the other task. In this paper, we develop a single diffusion model that can be used for both tasks. By using the Diffusion Posterior Sampling (DPS) approach, we use a diffusion model trained to simulate weak lensing maps for the inverse problem of reconstructing mass maps from noisy weak lensing data. We find that the standard DPS method leads to biased inference but we correct this bias by down weighting the likelihood term at early sampling time steps of the diffusion. Our method give us a way to reconstruct accurate high-resolution (sub-arcminute) mass maps that have the correct power spectrum and a range of non-Gaussian summary statistics. We discuss several applications enabled by the computational efficiency and accuracy of our model. These include generation of simulation quality mass maps, aiding covariance estimation for higher order statistics, and for finding filaments, voids and clusters from noisy lensing shear data. I. INTRODUCTION With the advent of Stage IV cosmological surveys such as Euclid [1], Vera Rubin Observatory\u2019s Legacy Survey of Space and Time [LSST, 2]and Roman Space Telescope [3], we are at the beginning of an unprecedented influx of high-quality data. Optimal analysis of these data sets will require major im- provements in our data analysis methods. Weak gravitational lensing gives us a unique way to probe the underlying matter distribution without relying on biased tracers of dark matter. An important data product for weak lensing analyses are the reconstructions of the underlying mass maps from noisy shear data [4, 5]. These mass maps are used for many astrophysi- cal applications such as cluster detection [6, 7] and studying the connection of gas and galaxies to the underlying matter. Apart from its astrophysical uses, they are also important for extracting the non-Gaussian cosmological information. The late time density field is highly non-Gaussian due to gravitational evolution. But traditional cosmological analyses have relied on 2-point statistics such as correlation functions and power spectra [8, 9], as a result leaving out a large part of the cosmological information [10\u201312]. Several studies have attempted to extract the non-Gaussian cosmological informa- tion. One approach uses non-Gaussian summary statistics such as moments of the mass maps [13], wavelet phase har- monics [14], peak and void counts [15, 16], scattering/wavelet transforms [17\u201319] or 1-pt PDF [20, 21], k-nearest neighbors [kNN, 22]. These summary statistics are usually too com- plicated to be modelled analytically and therefore we need to rely on simulations for such analyses [e.g, 14]. Recently the alternate approach of field-level inference (FLI) has been developed with the goal of optimally extracting non-Gaussian information from cosmological data [23\u201333]. Inference based on deep learning, primarily based on Con- volutional Neural Nets (CNNs), also serve as FLI approaches \u2217supranta@sas.upenn.edu \u2020 mgjacob@sas.upenn.edu \u2021 bjain@sas.upenn.edu [34\u201337]. For FLI as well, we need a field-level generative model for accurate inference. But in addition, we need to solve the inverse problem of reconstructing the cosmologi- cal field from noisy data. While in principle, we can use N- body simulations as our generative model, in practice compu- tational cost is prohibitive. This necessitates the development of fast and accurate cosmological simulations. Generative machine learning methods have been proposed as a fast alternative to N-body simulations for producing cos- mological fields. Generative models are machine learning methods that are trained to produce samples from the prob- ability distribution of the training data. By training genera- tive models on cosmological simulations, they can produce realistic fields at a fraction of the cost of N-body simula- tions. Many different generative models have been used in cosmological studies. For example, Generative Adversarial Networks (GANs) have been used as fast, surrogate models for N-body simulations [38\u201340] as well as for weak lensing and projected density maps [41\u201345]. Similarly, normalizing flows have also been used to produce fast cosmological maps [27, 46, 47]. In this paper, we focus on diffusion-based generative mod- els [48, 49]. In a diffusion model, noise is progressively added to the training data consisting of simulated maps (or images) until the resulting maps are simply maps of random Gaussian noise. Then a neural network is trained to learn (in a proba- bilistic sense) the reverse \u2018denoising\u2019 process. Once trained, the neural network can therefore produce realistic maps from noise. The reverse process requires the neural network to learn the gradient of the log-probability, \u2207x log p(x), which is called the score. Therefore, diffusion models are also re- ferred to as score-based generative models. Diffusion models have also been used in many cosmolog- ical and astrophysical applications [50\u201358]. In astrophysics, diffusion models have been used for two tasks: First, as a generative models for producing fast simulations. For exam- ple, [50] used diffusion models as a generative model for dust maps and dark matter simulations and [51] used them to pro- duce super-resolution simulations. Second, diffusion models are used to reconstruct an underlying astrophysical field from arXiv:2502.04158v1 [astro-ph.CO] 6 Feb 2025"
}